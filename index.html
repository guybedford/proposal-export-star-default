<!doctype html>
<head><meta charset="utf-8">
<title>ECMAScript export default from</title><script type="application/json" id="menu-search-biblio">[{"type":"clause","id":"intro","aoid":null,"title":"Introduction","titleHTML":"Introduction","number":"","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"Introduction"},{"type":"clause","id":"sec-getexportednames","aoid":null,"title":"GetExportedNames( exportStarSet ) Concrete Method","titleHTML":"GetExportedNames( <var>exportStarSet</var> ) Concrete Method","number":"1.1.1.1","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"GetExportedNames( exportStarSet ) Concrete Method"},{"type":"clause","id":"sec-resolveexport","aoid":null,"title":"ResolveExport( exportName, resolveSet, exportStarSet ) Concrete Method","titleHTML":"ResolveExport( <var>exportName</var>, <var>resolveSet</var>, <var>exportStarSet</var> ) Concrete Method","number":"1.1.1.2","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"ResolveExport( exportName, resolveSet, exportStarSet ) Concrete Method"},{"type":"clause","id":"sec-source-text-module-records","aoid":null,"title":"Source Text Module Records","titleHTML":"Source Text Module Records","number":"1.1.1","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"Source Text Module Records"},{"type":"clause","id":"sec-module-semantics","aoid":null,"title":"Module Semantics","titleHTML":"Module Semantics","number":"1.1","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"Module Semantics"},{"type":"clause","id":"sec-modules","aoid":null,"title":"Modules","titleHTML":"Modules","number":"1","namespace":"https://github.com/guybedford/proposal-export-star-default","location":"","key":"Modules"}]</script></head><body><div id="menu-toggle">☰</div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-pins"><div class="menu-pane-header">Pinned Clauses</div><ul id="menu-pins-list"></ul></div><div class="menu-pane-header">Table of Contents</div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle-none"></span><a href="#intro" title="Introduction">Introduction</a></li><li><span class="item-toggle">◢</span><a href="#sec-modules" title="Modules"><span class="secnum">1</span> Modules</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-module-semantics" title="Module Semantics"><span class="secnum">1.1</span> Module Semantics</a><ol class="toc"><li><span class="item-toggle">◢</span><a href="#sec-source-text-module-records" title="Source Text Module Records"><span class="secnum">1.1.1</span> Source Text Module Records</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-getexportednames" title="GetExportedNames( exportStarSet ) Concrete Method"><span class="secnum">1.1.1.1</span> GetExportedNames( <var>exportStarSet</var> ) Concrete Method</a></li><li><span class="item-toggle-none"></span><a href="#sec-resolveexport" title="ResolveExport( exportName, resolveSet, exportStarSet ) Concrete Method"><span class="secnum">1.1.1.2</span> ResolveExport( <var>exportName</var>, <var>resolveSet</var>, <var>exportStarSet</var> ) Concrete Method</a></li></ol></li></ol></li></ol></li></ol></div></div><div id="spec-container"><h1 class="version">Stage 0 Draft / November 18, 2016</h1><h1 class="title">ECMAScript export default from</h1>
<script src="https://bterlson.github.io/ecmarkup/ecmarkup.js" defer=""></script>
<link rel="stylesheet" href="https://bterlson.github.io/ecmarkup/elements.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_light.min.css">

<div id="spec-container">

<emu-intro id="intro">
  <h1>Introduction<span class="utils"><span class="anchor"><a href="#intro">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>

  <p>This proposal removes the restriction that <code>export * from</code> cannot export a <code>default</code> export.</p>

  <p>See  <a href="https://github.com/guybedford/proposal-export-star-default">the proposal repository</a> for further information.</p>

  <emu-note><span class="note">Note</span>
    <p>This spec proposal is written as a diff against the  <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-scripts-and-modules">Scripts and Modules section of the existing ECMAScript specification</a>.</p>
  </emu-note>
</emu-intro>

<!-- es6num="15.2" -->
<emu-clause id="sec-modules">
<h1><span class="secnum">1</span>Modules<span class="utils"><span class="anchor"><a href="#sec-modules">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>
<!-- es6num="15.2.1" -->
<emu-clause id="sec-module-semantics">
<h1><span class="secnum">1.1</span>Module Semantics<span class="utils"><span class="anchor"><a href="#sec-module-semantics">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>
<!-- es6num="15.2.1.16" -->
<emu-clause id="sec-source-text-module-records">
<h1><span class="secnum">1.1.1</span>Source Text Module Records<span class="utils"><span class="anchor"><a href="#sec-source-text-module-records">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>

<!-- es6num="15.2.1.16.2" -->
<emu-clause id="sec-getexportednames">
  <h1><span class="secnum">1.1.1.1</span>GetExportedNames( <var>exportStarSet</var> ) Concrete Method<span class="utils"><span class="anchor"><a href="#sec-getexportednames">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>
  <emu-note><span class="note">Note 1</span>This is  <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-getexportednames">Section 15.2.1.16.2</a> in the current spec.</emu-note>
  <p>The GetExportedNames concrete method of a <emu-xref href="#sec-source-text-module-records"><a href="#sec-source-text-module-records">Source Text Module Record</a></emu-xref> with argument <var>exportStarSet</var> performs the following steps:</p>
  <emu-alg><ol><li>Let <var>module</var> be this <emu-xref href="#sec-source-text-module-records"><a href="#sec-source-text-module-records">Source Text Module Record</a></emu-xref>.</li><li>If <var>exportStarSet</var> contains <var>module</var>, then<ol><li>Assert: We've reached the starting point of an <code>import *</code> circularity.</li><li>Return a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li></ol></li><li>Append <var>module</var> to <var>exportStarSet</var>.</li><li>Let <var>exportedNames</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[LocalExportEntries]], do<ol><li>Assert: <var>module</var> provides the direct binding for this export.</li><li>Append <var>e</var>.[[ExportName]] to <var>exportedNames</var>.</li></ol></li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[IndirectExportEntries]], do<ol><li>Assert: <var>module</var> imports a specific binding for this export.</li><li>Append <var>e</var>.[[ExportName]] to <var>exportedNames</var>.</li></ol></li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[StarExportEntries]], do<ol><li>Let <var>requestedModule</var> be ? <emu-xref aoid="HostResolveImportedModule"><a href="https://tc39.github.io/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref>(<var>module</var>, <var>e</var>.[[ModuleRequest]]).</li><li>Let <var>starNames</var> be ? <var>requestedModule</var>.GetExportedNames(<var>exportStarSet</var>).</li><li>For each element <var>n</var> of <var>starNames</var>, do<ol><li><del>If <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>n</var>, <code>"default"</code>) is <emu-val>false</emu-val>, then</del><ol><li>If <var>n</var> is not an element of <var>exportedNames</var>, then<ol><li>Append <var>n</var> to <var>exportedNames</var>.</li></ol></li></ol></li></ol></li></ol></li><li>Return <var>exportedNames</var>.
  </li></ol></emu-alg>
  <emu-note><span class="note">Note 2</span>
    <p>GetExportedNames does not filter out or throw an exception for names that have ambiguous star export bindings.</p>
  </emu-note>
</emu-clause>

<!-- es6num="15.2.1.16.3" -->
<emu-clause id="sec-resolveexport">
  <h1><span class="secnum">1.1.1.2</span>ResolveExport( <var>exportName</var>, <var>resolveSet</var>, <var>exportStarSet</var> ) Concrete Method<span class="utils"><span class="anchor"><a href="#sec-resolveexport">link</a></span><span class="anchor"><a href="#" class="utils-pin">pin</a></span></span></h1>
  <emu-note><span class="note">Note 1</span>This is  <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-resolveexport">Section 15.2.1.16.3</a> in the current spec.</emu-note>
  <p>The ResolveExport concrete method of a <emu-xref href="#sec-source-text-module-records"><a href="#sec-source-text-module-records">Source Text Module Record</a></emu-xref> with arguments <var>exportName</var>, <var>resolveSet</var>, and <var>exportStarSet</var> performs the following steps:</p>
  <emu-alg><ol><li>Let <var>module</var> be this <emu-xref href="#sec-source-text-module-records"><a href="#sec-source-text-module-records">Source Text Module Record</a></emu-xref>.</li><li>For each <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Module]], [[ExportName]]} <var>r</var> in <var>resolveSet</var>, do:<ol><li>If <var>module</var> and <var>r</var>.[[Module]] are the same <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.github.io/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> and <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>exportName</var>, <var>r</var>.[[ExportName]]) is <emu-val>true</emu-val>, then<ol><li>Assert: This is a circular import request.</li><li>Return <emu-val>null</emu-val>.</li></ol></li></ol></li><li>Append the <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Module]]: <var>module</var>, [[ExportName]]: <var>exportName</var>} to <var>resolveSet</var>.</li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[LocalExportEntries]], do<ol><li>If <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>exportName</var>, <var>e</var>.[[ExportName]]) is <emu-val>true</emu-val>, then<ol><li>Assert: <var>module</var> provides the direct binding for this export.</li><li>Return <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref>{[[Module]]: <var>module</var>, [[BindingName]]: <var>e</var>.[[LocalName]]}.</li></ol></li></ol></li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[IndirectExportEntries]], do<ol><li>If <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>exportName</var>, <var>e</var>.[[ExportName]]) is <emu-val>true</emu-val>, then<ol><li>Assert: <var>module</var> imports a specific binding for this export.</li><li>Let <var>importedModule</var> be ? <emu-xref aoid="HostResolveImportedModule"><a href="https://tc39.github.io/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref>(<var>module</var>, <var>e</var>.[[ModuleRequest]]).</li><li>Return ? <var>importedModule</var>.ResolveExport(<var>e</var>.[[ImportName]], <var>resolveSet</var>, <var>exportStarSet</var>).</li></ol></li></ol></li><li><del>If <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>exportName</var>, <code>"default"</code>) is <emu-val>true</emu-val>, then</del><ol><li><del>Assert: A <code>default</code> export was not explicitly defined by this module.</del></li><li><del>Return <emu-val>null</emu-val>.</del></li><li><del>NOTE A <code>default</code> export cannot be provided by an <code>export *</code>.</del></li></ol></li><li>If <var>exportStarSet</var> contains <var>module</var>, return <emu-val>null</emu-val>.</li><li>Append <var>module</var> to <var>exportStarSet</var>.</li><li>Let <var>starResolution</var> be <emu-val>null</emu-val>.</li><li>For each ExportEntry <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> <var>e</var> in <var>module</var>.[[StarExportEntries]], do<ol><li>Let <var>importedModule</var> be ? <emu-xref aoid="HostResolveImportedModule"><a href="https://tc39.github.io/ecma262/#sec-hostresolveimportedmodule">HostResolveImportedModule</a></emu-xref>(<var>module</var>, <var>e</var>.[[ModuleRequest]]).</li><li>Let <var>resolution</var> be ? <var>importedModule</var>.ResolveExport(<var>exportName</var>, <var>resolveSet</var>, <var>exportStarSet</var>).</li><li>If <var>resolution</var> is <code>"ambiguous"</code>, return <code>"ambiguous"</code>.</li><li>If <var>resolution</var> is not <emu-val>null</emu-val>, then<ol><li>If <var>starResolution</var> is <emu-val>null</emu-val>, let <var>starResolution</var> be <var>resolution</var>.</li><li>Else,<ol><li>Assert: There is more than one <code>*</code> import that includes the requested name.</li><li>If <var>resolution</var>.[[Module]] and <var>starResolution</var>.[[Module]] are not the same <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.github.io/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> or <emu-xref aoid="SameValue"><a href="https://tc39.github.io/ecma262/#sec-samevalue">SameValue</a></emu-xref>(<var>resolution</var>.[[BindingName]], <var>starResolution</var>.[[BindingName]]) is <emu-val>false</emu-val>, return <code>"ambiguous"</code>.</li></ol></li></ol></li></ol></li><li>Return <var>starResolution</var>.
  </li></ol></emu-alg>
  <emu-note><span class="note">Note 2</span>
    <p>ResolveExport attempts to resolve an imported binding to the actual defining module and local binding name. The defining module may be the module represented by the <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.github.io/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> this method was invoked on or some other module that is imported by that module. The parameter <var>resolveSet</var> is use to detect unresolved circular import/export paths. If a pair consisting of specific <emu-xref href="#sec-abstract-module-records"><a href="https://tc39.github.io/ecma262/#sec-abstract-module-records">Module Record</a></emu-xref> and <var>exportName</var> is reached that is already in <var>resolveSet</var>, an import circularity has been encountered. Before recursively calling ResolveExport, a pair consisting of <var>module</var> and <var>exportName</var> is added to <var>resolveSet</var>.</p>
    <p>If a defining module is found a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">Record</a></emu-xref> {[[Module]], [[BindingName]]} is returned. This record identifies the resolved binding of the originally requested export. If no definition was found or the request is found to be circular, <emu-val>null</emu-val> is returned. If the request is found to be ambiguous, the string <code>"ambiguous"</code> is returned.</p>
  </emu-note>
</emu-clause>

</emu-clause>
</emu-clause>
</emu-clause>

</div>
</div></body>